#!/bin/bash
#PBS -l mem=6gb
#PBS -t 0-131

### Motif score calculation: matrix score **0.86
### Combined with Homer Known motifs

wk_dir=/gpfs/home/hdiao/jycATAC/6_GeneGroupMotifAnalysis/byGroup_DEseqComparisons
preparsed_dir=/gpfs/home/hdiao/resources
mm10_genome=/gpfs/group/databases/Mus_musculus/UCSC/mm10/Sequence/Bowtie2Index/genome.fa

cd $wk_dir

export PATH="/gpfs/home/hdiao/homer/bin:$PATH"

sp_names=(Group_I--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_up Group_I--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_dn Group_I--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_up Group_II--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_dn Group_II--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_up Group_III--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_dn Group_III--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_up Group_IV--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_dn Group_IV--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_up TFH_Associated--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_dn TFH_Associated--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Tfh-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-Bcl6KO_Th1_vs_WT_Th1-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_Prdm1KO_Tfh-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Tfh-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Tfh_vs_WT_Th1-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_Bcl6KO_Th1-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Tfh-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-DKO_Th1_vs_WT_Th1-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Tfh-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-Prdm1KO_Tfh_vs_WT_Th1-pval-0.05_up TH1_Associated--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_dn TH1_Associated--ATAC_peaksall.df.numx.c5-WT_Tfh_vs_WT_Th1-pval-0.05_up)
bed_name=${sp_names[$PBS_ARRAYID]}.bed
out_name=${sp_names[$PBS_ARRAYID]}_cb_mtfs

findMotifsGenome.pl $bed_name $mm10_genome $out_name -size given -mask -preparsedDir $preparsed_dir
