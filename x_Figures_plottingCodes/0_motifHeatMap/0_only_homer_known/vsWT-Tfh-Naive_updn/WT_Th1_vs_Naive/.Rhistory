show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 2.5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 2.8, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 3, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 0.5, cellheight = 0.5,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 3, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 2, cellheight = 2,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 3, cellheight = 3,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 4, cellheight = 4,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 8, cellheight = 8,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,kmeans_k = 5,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,kmeans_k = 5,
cluster_cols = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c25-WT_Tfh_vs_Naive_diffHeatmap.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(20,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
#################### motifHeatMap ####################
# Author: Huitian (Yolanda) Diao
# Nov 9th , 2018
# Dependencies:
# 1. Data prep <- prep_motifHeatMap.py <- fc_motifHeatMap.py
# 2. Motif finding <- Homer
# etc...
#################### Imports ####################
library(pheatmap)
library(RColorBrewer)
library(viridis)
#################### Self-defined functions ####################
fnameNoPathPdf <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "new.pdf", namex)
return(namex)
}
fnameNoPath <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "", namex)
return(namex)
}
save_pheatmap_pdf <- function(x, filename, width=7, height=7) {
stopifnot(!missing(x))
stopifnot(!missing(filename))
pdf(filename, width=width, height=height)
grid::grid.newpage()
grid::grid.draw(x$gtable)
dev.off()
}
setRnames <- function(tabx){
row.names(tabx) <- unlist(tabx[,1])
head(tabx)
tabx[,1] <- NULL
return(tabx)
}
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10_heatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlOrRd"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c25_heatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlOrRd"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c10_heatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlGnBu"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c25_heatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlGnBu"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsWT-Tfh_pval-0.05_up-sig_c10_heatmap_byWTTfh.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlOrRd"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsWT-Tfh_pval-0.05_up-sig_c25_heatmap_byWTTfh.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlOrRd"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsWT-Tfh_pval-0.05_dn-sig_c10_heatmap_byWTTfh.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlGnBu"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsWT-Tfh_pval-0.05_dn-sig_c10_heatmap_byWTTfh.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlGnBu"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 15)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsWT-Tfh_pval-0.05_dn-sig_c10_heatmap_byWTTfh.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlGnBu"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 12)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsNaive_updn"
setwd(wk.dir)
infile <- "vsWT-Tfh_pval-0.05_dn-sig_c25_heatmap_byWTTfh.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = brewer.pal(9,"YlGnBu"), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(11,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c25-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(11,"RdBu")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(11,"PuOr")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c25-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
heat.map <- pheatmap(mat = intab, color = rev(brewer.pal(11,"PuOr")), border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
myBreaks <- seq(-6, 6, by=0.5)
myBreaks
length(myBreaks)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myColor <- colorRampPalette(c("blue", "white", "red"))(50)
myBreaks <- seq(-6, 6, by=0.25)
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-8, 8, by=0.25)
myColor <- colorRampPalette(c("blue", "white", "red"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-8, 8, by=0.25)
myColor <- colorRampPalette(c("blue", "white", "red4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-8, 8, by=0.25)
myColor <- colorRampPalette(c("royalblue4","royalblueblue1", "white", "red1", "red4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-8, 8, by=0.25)
myColor <- colorRampPalette(c("royalblue4","royalblue1", "white", "red1", "red4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c25-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-8, 8, by=0.25)
myColor <- colorRampPalette(c("royalblue4","royalblue1", "white", "red1", "red4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-8, 8, by=0.25)
myColor <- colorRampPalette(c("mediumpurple4","mediumpurple1", "white", "orange1", "orange4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-9, 9, by=0.25)
myColor <- colorRampPalette(c("mediumpurple4","mediumpurple1", "white", "orange1", "orange4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c10-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-10, 10, by=0.25)
myColor <- colorRampPalette(c("mediumpurple4","mediumpurple1", "white", "orange1", "orange4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Tfh_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c25-WT_Tfh_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-10, 10, by=0.25)
myColor <- colorRampPalette(c("mediumpurple4","mediumpurple1", "white", "orange1", "orange4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Th1_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c10-WT_Th1_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-8, 8, by=0.25)
myColor <- colorRampPalette(c("royalblue4","royalblue1", "white", "red1", "red4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Th1_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_up-sig_c25-WT_Th1_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-8, 8, by=0.25)
myColor <- colorRampPalette(c("royalblue4","royalblue1", "white", "red1", "red4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Th1_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c10-WT_Th1_vs_Naive_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-10, 10, by=0.25)
myColor <- colorRampPalette(c("mediumpurple4","mediumpurple1", "white", "orange1", "orange4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Th1_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c10-WT_Th1_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-10, 10, by=0.25)
myColor <- colorRampPalette(c("mediumpurple4","mediumpurple1", "white", "orange1", "orange4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/vsWT-Tfh-Naive_updn/WT_Th1_vs_Naive"
setwd(wk.dir)
infile <- "vsNaive_pval-0.05_dn-sig_c25-WT_Th1_vs_Naive_diffHeatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(-10, 10, by=0.25)
myColor <- colorRampPalette(c("mediumpurple4","mediumpurple1", "white", "orange1", "orange4"))(length(myBreaks))
heat.map <- pheatmap(mat = intab, color=myColor, breaks=myBreaks, border_color = "white",
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9,
cluster_cols = FALSE, cluster_rows = TRUE)
save_pheatmap_pdf(heat.map, outname, 5, 10)
