covertGN(c("Mll1", "Mll2"), c("Abc", "Def", "Mll1"), c("aBC", "dEF", "Kmt2a"))
convertGN(c("Mll1", "Mll2"), c("Abc", "Def", "Mll1"), c("aBC", "dEF", "Kmt2a"))
convertGN <- function(in.vec, cov.old, cov.new){
for (x in c(1:length(in.vec))){
if (in.vec[x] %in% cov.old){
idx <- match(in.vec[x], cov.old)
in.vec[x] <- cov.new[idx]
}
}
return(in.vec)
}
convertGN(c("Mll1", "Mll2"), c("Abc", "Def", "Mll1"), c("aBC", "dEF", "Kmt2a"))
BiocManager::install("MEDIPS")
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target_cluster.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
tgt.genes <- tgt.tb$GeneID
tgt.genes <- convertGN(tgt.genes, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)
tgt.genes.upper <- toupper(tgt.genes)
tgt.genes.lower.upper <- c(tgt.genes, tgt.genes.upper)
biogrid.tb.tgt <- biogrid.tb %>%
filter(OFFICIAL_SYMBOL_A %in% tgt.genes.lower.upper)
nrow(biogrid.tb.tgt)
tgt.genes
tgt.genes <- tgt.tb$GeneID
tgt.genes
length(tgt.genes)
tgt.genes <- convertGN(tgt.genes, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)
length(tgt.genes)
tgt.genes
tgt.genes <- tgt.tb$GeneID
tgt.genes
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval"
setwd(wk.dir)
z.p.file <- "all_z-score_div_sqrt-p_sqrt.csv"
z.p.tb <- read_csv(z.p.file)
#z.p.tb <- z.p.tb %>% column_to_rownames("gene_name")
colnames(z.p.tb)
###----- Find genes that are on top / bottom of list in different cases
#--- Q4 v.s. Q1
z.p.tb <- z.p.tb %>% arrange(Q4minusQ1)
qt <- as.integer(floor(nrow(z.p.tb)/8))
q4_q1_dn <- z.p.tb$gene_name[1: qt]
q4_q1_up <- z.p.tb$gene_name[(nrow(z.p.tb)-qt+1): nrow(z.p.tb)]
#--- Q3 v.s. Other
z.p.tb <- z.p.tb %>% arrange(Q3minusOther)
qt <- as.integer(floor(nrow(z.p.tb)/8))
q3_o_dn <- z.p.tb$gene_name[1: qt]
q3_o_up <- z.p.tb$gene_name[(nrow(z.p.tb)-qt+1): nrow(z.p.tb)]
#--- Input v.s. Avg
z.p.tb <- z.p.tb %>% arrange(InputMinusAvg)
qt <- as.integer(floor(nrow(z.p.tb)/8))
in_a_dn <- z.p.tb$gene_name[1: qt]
in_a_up <- z.p.tb$gene_name[(nrow(z.p.tb)-qt+1): nrow(z.p.tb)]
###----- All genes that are on top / bottom in any case
all.tgt <- c(q4_q1_dn, q4_q1_up, q3_o_dn, q3_o_up, in_a_dn, in_a_up)
all.tgt <- unique(all.tgt)
length(all.tgt)
#####---------- Heatmaps
col.pal <- colorRampPalette(brewer.pal(n=11, name="RdBu"))
col.use <- rev(col.pal(50))
###----- Heatmap of all targets
target.tb <- z.p.tb %>% filter(gene_name %in% all.tgt) %>% column_to_rownames("gene_name")
#target.heatmap <- pheatmap(target.tb , color=col.use, cluster_cols = FALSE,
#                           clustering_distance_rows="canberra")
head(target.tb)
write_csv(target.tb, "target.tb.csv")
nrow(target.tb)
target.tb <- z.p.tb %>% filter(gene_name %in% all.tgt)
write_csv(target.tb, "target.tb.csv")
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.tb.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
tgt.genes <- tgt.tb$GeneID
tgt.genes <- convertGN(tgt.genes, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)
length(tgt.genes)
tgt.genes
tgt.genes.upper <- toupper(tgt.genes)
tgt.genes.lower.upper <- c(tgt.genes, tgt.genes.upper)
biogrid.tb.tgt <- biogrid.tb %>%
filter(OFFICIAL_SYMBOL_A %in% tgt.genes.lower.upper)
nrow(biogrid.tb.tgt)
tgt.genes <- tgt.tb$gene_name
tgt.genes <- convertGN(tgt.genes, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)
length(tgt.genes)
tgt.genes
tgt.genes.upper <- toupper(tgt.genes)
tgt.genes.lower.upper <- c(tgt.genes, tgt.genes.upper)
biogrid.tb.tgt <- biogrid.tb %>%
filter(OFFICIAL_SYMBOL_A %in% tgt.genes.lower.upper)
nrow(biogrid.tb.tgt)
head(biogrid.tb.tgt)
biogrid.tb.tgt <- biogrid.tb %>%
filter(OFFICIAL_SYMBOL_A %in% tgt.genes.lower.upper) %>%
filter(OFFICIAL_SYMBOL_B %in% tgt.genes.lower.upper)
nrow(biogrid.tb.tgt)
head(biogrid.tb.tgt)
biogrid.tb.tgt <- biogrid.tb.tgt %>%
distinct()
nrow(biogrid.tb.tgt)
write_csv(biogrid.tb.tgt, "CRF_target_biogrid.csv")
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
tgt.genes <- tgt.tb$gene_name
tgt.genes <- convertGN(tgt.genes, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)
length(tgt.genes)
tgt.genes
tgt.genes.upper <- toupper(tgt.genes)
tgt.genes.lower.upper <- c(tgt.genes, tgt.genes.upper)
biogrid.tb.tgt <- biogrid.tb %>%
filter(OFFICIAL_SYMBOL_A %in% tgt.genes.lower.upper) %>%
filter(OFFICIAL_SYMBOL_B %in% tgt.genes.lower.upper)
biogrid.tb.tgt <- biogrid.tb.tgt %>%
distinct()
nrow(biogrid.tb.tgt)
colnames(biogrid.tb.tgt)
tgt.tb <- tgt.tb %>% mutate(gene_name = toupper(gene_name))
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
colnames(tgt.tb)
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = toupper(gene_name))
colnames(tgt.tb)
colnames(crf.gn.alt.tb)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
colnames(crf.gn.alt.tb)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
colnames(tgt.tb)
colnames(biogrid.tb)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name)
nrow(biogrid.tb.tgt)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct()
nrow(biogrid.tb.tgt)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(biogrid.tb.tgt)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by=gene_name)
colnames(tgt.tb)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(gene_name = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(gene_name2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(gene_name, gene_name2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(tgt.tb)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(gene_name %in% tgt.tb$gene_name) %>%
filter(gene_name2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(tgt.tb)
colnames(biogrid.tb.tgt)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(gene_name = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(gene_name2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(gene_name, gene_name2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(gene_name %in% tgt.tb$gene_name) %>%
filter(gene_name2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name") %>%
mutate(interation="pp")
write_csv(biogrid.tb.tgt, "CRF_target_biogrid.csv")
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
#################### motifHeatMap ####################
# Author: Huitian (Yolanda) Diao
# Nov 9th , 2018
# Dependencies:
# 1. Data prep <- prep_motifHeatMap.py <- fc_motifHeatMap.py
# 2. Motif finding <- Homer
# etc...
#################### Imports ####################
library(pheatmap)
library(RColorBrewer)
library(viridis)
#################### Self-defined functions ####################
fnameNoPathPdf <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "new.pdf", namex)
return(namex)
}
fnameNoPath <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "", namex)
return(namex)
}
save_pheatmap_pdf <- function(x, filename, width=7, height=7) {
stopifnot(!missing(x))
stopifnot(!missing(filename))
pdf(filename, width=width, height=height)
grid::grid.newpage()
grid::grid.draw(x$gtable)
dev.off()
}
setRnames <- function(tabx){
row.names(tabx) <- unlist(tabx[,1])
head(tabx)
tabx[,1] <- NULL
return(tabx)
}
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs_c25_byfamily.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(0, 80, by=1)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "gray90",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 50)
}
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs_c25_byfamily.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsNaive-up_all_sig_motifs.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
infile <- "vsNaive-dn_all_sig_motifs.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab <- setRnames(intab)
library(tidyverse)
library(dplyr)
infile <- "vsNaive-dn_all_sig_motifs.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab <- setRnames(intab)
infile <- "vsNaive-dn_all_sig_motifs.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
colnames(intab)
intab <- read_csv(infile) %>% column_to_rownames("motif_name")
intab <- read_csv(infile) %>% dinstinct() %>% column_to_rownames("motif_name")
intab <- read_csv(infile) %>% distinct() %>% column_to_rownames("motif_name")
intab <- read_csv(infile) %>% distinct() %>% column_to_rownames("motif_name")
plot_heatmap("vsNaive-up_all_sig_motifs_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
infile <- "vsNaive-dn_all_sig_motifs_rmdup.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile) %>% distinct() %>% column_to_rownames("motif_name")
colnames(intab)
intab.sltcols <- c( c("motif_name"), colnames(intab)[6:length(colnames(intab))])
intab.sltcols
intab.sltcols <- c( c("motif_name"), colnames(intab)[5:length(colnames(intab))])
intab.sltcols
infile <- "vsNaive-dn_all_sig_motifs_rmdup.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab.sltcols <- c( c("motif_name"), colnames(intab)[5:length(colnames(intab))])
intab <- intab %>% select(one_of(intab.colcols)) %>% distinct() %>% column_to_rownames("motif_name")
intab <- intab %>% select(one_of(intab.sltcols)) %>% distinct() %>% column_to_rownames("motif_name")
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
#################### Main ####################
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
#################### Main ####################
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
#################### Main ####################
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
infile <- "vsNaive-dn_all_sig_motifs.srt_rmdup.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab.sltcols <- c( c("motif_name"), colnames(intab)[5:length(colnames(intab))])
intab <- intab %>% select(one_of(intab.sltcols)) %>% distinct() %>% column_to_rownames("motif_name")
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs.srt_rmdup.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab.sltcols <- c( c("motif_name"), colnames(intab)[5:length(colnames(intab))])
intab <- intab %>% select(one_of(intab.sltcols)) %>% distinct() %>% column_to_rownames("motif_name")
myBreaks <- seq(0, 80, by=1)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "gray90",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 50)
}
#################### Main ####################
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
infile <- "vsNaive-dn_all_sig_motifs.srt_rmdup.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab.sltcols <- c( c("motif_name"), colnames(intab)[5:length(colnames(intab))])
intab <- intab %>% select(one_of(intab.sltcols)) %>% distinct() %>% column_to_rownames("motif_name")
myBreaks <- seq(0, 80, by=1)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "gray90",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
head(intab)
infile <- "vsNaive-dn_all_sig_motifs.srt_rmdup.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab.sltcols <- c( c("motif_name"), colnames(intab)[6:length(colnames(intab))])
intab <- intab %>% select(one_of(intab.sltcols)) %>% distinct() %>% column_to_rownames("motif_name")
head(intab)
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs.srt_rmdup.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab.sltcols <- c( c("motif_name"), colnames(intab)[6:length(colnames(intab))])
intab <- intab %>% select(one_of(intab.sltcols)) %>% distinct() %>% column_to_rownames("motif_name")
myBreaks <- seq(0, 80, by=1)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "gray90",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 50)
}
#################### Main ####################
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs.srt_rmdup.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab.sltcols <- c( c("motif_name"), colnames(intab)[6:length(colnames(intab))])
intab <- intab %>% select(one_of(intab.sltcols)) %>% distinct() %>% column_to_rownames("motif_name")
myBreaks <- seq(0, 80, by=1)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "gray90",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 100)
}
#################### Main ####################
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs.srt_rmdup.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read_csv(infile)
intab.sltcols <- c( c("motif_name"), colnames(intab)[6:length(colnames(intab))])
intab <- intab %>% select(one_of(intab.sltcols)) %>% distinct() %>% column_to_rownames("motif_name")
myBreaks <- seq(0, 80, by=1)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "gray90",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 5, 80)
}
#################### Main ####################
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/add_bcl6"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/add_bcl6"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/add_bcl6"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
