mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
colnames(tgt.tb)
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = toupper(gene_name))
colnames(tgt.tb)
colnames(crf.gn.alt.tb)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
colnames(crf.gn.alt.tb)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
colnames(tgt.tb)
colnames(biogrid.tb)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name)
nrow(biogrid.tb.tgt)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct()
nrow(biogrid.tb.tgt)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(biogrid.tb.tgt)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by=gene_name)
colnames(tgt.tb)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(gene_name = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(gene_name2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(gene_name, gene_name2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(tgt.tb)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(gene_name %in% tgt.tb$gene_name) %>%
filter(gene_name2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(tgt.tb)
colnames(biogrid.tb.tgt)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(gene_name = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(gene_name2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(gene_name, gene_name2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(gene_name %in% tgt.tb$gene_name) %>%
filter(gene_name2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name") %>%
mutate(interation="pp")
write_csv(biogrid.tb.tgt, "CRF_target_biogrid.csv")
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
if(TRUE) {
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
}
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
open.slt.tb$names
open.slt.vec <- as.character(unlist(open.slt.tb$names))
open.slt.vec <- toupper(as.character(unlist(open.slt.tb$names)))
open.slt.vec
close.slt.vec <- toupper(as.character(unlist(close.slt.tb$names)))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb <- read_csv(open.slt.file)
open.slt.vec <- toupper(as.character(unlist(open.slt.tb$names)))
close.slt.vec <- toupper(as.character(unlist(close.slt.tb$names)))
lose.slt.tb <- read_csv(close.slt.file)
close.slt.vec <- toupper(as.character(unlist(close.slt.tb$names)))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb <- read_csv(open.slt.file)
open.slt.vec <- toupper(as.character(unlist(open.slt.tb$names)))
close.slt.vec <- toupper(as.character(unlist(close.slt.tb$names)))
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
open.tb$motif_name
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- strsplit(in_vec[i], "\\(")
simp_i <- strsplit(simp_i, "\\+")
out_vec[i] <- simp_i
}
return(out_vec)
}
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- strsplit(in_vec[i], "\\(")
simp_i <- strsplit(simp_i, "\\+")
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- strsplit(in_vec[i], "\\(")[1]
simp_i <- strsplit(simp_i, "\\+")[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
open.tb$simp_names
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb <- read_csv(open.slt.file)
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
open.slt.tb
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb$simp_names <- toupper(open.slt.tb$simp_names)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Select motifs & plot
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
open.slt.tb
open.slt.tb$motif_name
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb$simp_names <- toupper(open.slt.tb$simp_names)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Select motifs & plot
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
open.slt.tb$motif_name
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb$simp_names <- toupper(open.slt.tb$simp_names)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Select motifs & plot
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
close.slt.tb <- close.slt.tb %>% left_join(close.tb, by="simp_names")
open.slt.tb$motif_name
close.slt.tb$motif_name
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb$simp_names <- toupper(open.slt.tb$simp_names)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Select motifs & plot
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
close.slt.tb <- close.slt.tb %>% left_join(close.tb, by="simp_names")
open.slt.tb$motif_name
close.slt.tb$motif_name
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb$simp_names <- toupper(open.slt.tb$simp_names)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Select motifs & plot
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
close.slt.tb <- close.slt.tb %>% left_join(close.tb, by="simp_names")
open.slt.tb$motif_name
close.slt.tb$motif_name
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb$simp_names <- toupper(open.slt.tb$simp_names)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Select motifs & plot
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
close.slt.tb <- close.slt.tb %>% left_join(close.tb, by="simp_names")
write_csv(open.slt.tb, "vsWTTfh-up_all_sig_motifs.srt_rmdup_selected.csv")
write_csv(close.slt.tb, "vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected.csv")
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb$simp_names <- toupper(open.slt.tb$simp_names)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Select motifs & plot
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
close.slt.tb <- close.slt.tb %>% left_join(close.tb, by="simp_names")
write_csv(open.slt.tb, "vsWTTfh-up_all_sig_motifs.srt_rmdup_selected.csv")
write_csv(close.slt.tb, "vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected.csv")
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 5, 40)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 5, 40)
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 5, 40)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 5, 40)
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 5, 40)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 5, 40)
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 5, 40)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 5, 40)
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 5, 40, 60)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 5, 40, 60)
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 3, 20, 60)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 3, 20, 60)
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 3, 10, 60)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 3, 10, 60)
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 3, 8, 60)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 3, 8, 60)
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/20190701"
setwd(wk.dir)
# Read selection motif list files
open.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_open.txt"
close.slt.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/ATAC-Seq_Analyses_JYC_20190701_close.txt"
open.slt.tb <- read_csv(open.slt.file)
close.slt.tb <- read_csv(close.slt.file)
open.slt.tb$simp_names <- toupper(open.slt.tb$simp_names)
close.slt.tb$simp_names <- toupper(close.slt.tb$simp_names)
# Read motif enrichment files
open.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-up_all_sig_motifs.srt_rmdup.csv"
close.file <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps/all_sig/vsWTTfh-dn_all_sig_motifs.srt_rmdup.csv"
open.tb <- read_csv(open.file)
close.tb <- read_csv(close.file)
# Convert names to simple format (without family names)
simp_name <- function(in_vec){
out_vec <- character(length(in_vec))
for (i in c(1: length(in_vec))){
simp_i <- unlist(strsplit(in_vec[i], "\\("))[1]
simp_i <- unlist(strsplit(simp_i, "\\+"))[1]
out_vec[i] <- toupper(simp_i)
}
return(out_vec)
}
open.tb$simp_names <- simp_name(open.tb$motif_name)
close.tb$simp_names <- simp_name(close.tb$motif_name)
# Select motifs & plot
open.slt.tb <- open.slt.tb %>% left_join(open.tb, by="simp_names")
close.slt.tb <- close.slt.tb %>% left_join(close.tb, by="simp_names")
write_csv(open.slt.tb, "vsWTTfh-up_all_sig_motifs.srt_rmdup_selected.csv")
write_csv(close.slt.tb, "vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected.csv")
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 3, 8, 60)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 3, 8, 60)
plot_heatmap("vsWTTfh-up_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlOrRd"), "black"), 3, 8, 60)
plot_heatmap("vsWTTfh-dn_all_sig_motifs.srt_rmdup_selected_use.csv", c("white",brewer.pal(5,"YlGnBu"), "black"), 3, 8, 60)
