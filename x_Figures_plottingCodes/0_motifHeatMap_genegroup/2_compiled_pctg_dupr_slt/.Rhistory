crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
tgt.genes <- tgt.tb$gene_name
tgt.genes <- convertGN(tgt.genes, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)
length(tgt.genes)
tgt.genes
tgt.genes.upper <- toupper(tgt.genes)
tgt.genes.lower.upper <- c(tgt.genes, tgt.genes.upper)
biogrid.tb.tgt <- biogrid.tb %>%
filter(OFFICIAL_SYMBOL_A %in% tgt.genes.lower.upper) %>%
filter(OFFICIAL_SYMBOL_B %in% tgt.genes.lower.upper)
biogrid.tb.tgt <- biogrid.tb.tgt %>%
distinct()
nrow(biogrid.tb.tgt)
colnames(biogrid.tb.tgt)
tgt.tb <- tgt.tb %>% mutate(gene_name = toupper(gene_name))
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
colnames(tgt.tb)
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = toupper(gene_name))
colnames(tgt.tb)
colnames(crf.gn.alt.tb)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
colnames(crf.gn.alt.tb)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
colnames(tgt.tb)
colnames(biogrid.tb)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name)
nrow(biogrid.tb.tgt)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct()
nrow(biogrid.tb.tgt)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(genename = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(genename2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(genename, genename2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(biogrid.tb.tgt)
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by=gene_name)
colnames(tgt.tb)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(gene_name = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(gene_name2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(gene_name, gene_name2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(genename %in% tgt.tb$gene_name) %>%
filter(genename2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(tgt.tb)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(gene_name %in% tgt.tb$gene_name) %>%
filter(gene_name2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name")
colnames(tgt.tb)
colnames(biogrid.tb.tgt)
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein"
setwd(wk.dir)
###----- Read inputs
tgt.file <- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/target.heatmap.clusters.csv"
tgt.tb <- read_csv(tgt.file)
crf.gn.alt.file <- "/Volumes/Yolanda/CRF_Screen/Ref/CRF_alternative_gn.csv"
crf.gn.alt.tb <- read_csv(crf.gn.alt.file)
biogrid.ref <- "/Volumes/Yolanda/CRF_Screen/Ref/BIOGRID.use_simp.txt"
biogrid.tb <- read_delim(biogrid.ref, "\t")
###----- Convert mouse gene names to all upper case (match with human)
tgt.tb <- tgt.tb %>%
mutate(gene_name = convertGN(gene_name, crf.gn.alt.tb$Alternative, crf.gn.alt.tb$gene_name)) %>%
mutate(gene_name = toupper(gene_name))
biogrid.tb <- biogrid.tb %>%
mutate(gene_name = toupper(OFFICIAL_SYMBOL_A)) %>%
mutate(gene_name2 = toupper(OFFICIAL_SYMBOL_B)) %>%
select(gene_name, gene_name2)
###----- Select mouse / human genes from biogrid spreadsheet
biogrid.tb.tgt <- biogrid.tb %>%
filter(gene_name %in% tgt.tb$gene_name) %>%
filter(gene_name2 %in% tgt.tb$gene_name) %>%
distinct() %>%
left_join(tgt.tb, by="gene_name") %>%
mutate(interation="pp")
write_csv(biogrid.tb.tgt, "CRF_target_biogrid.csv")
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*.csv", full.names=FALSE, recursive=FALSE)
slt.genes <- read_delim("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes
unlist(strsplit("bHLHE41(bHLH)", '('))[1]
unlist(strsplit("bHLHE41(bHLH)", '/('))[1]
unlist(strsplit("bHLHE41(bHLH)", '//('))[1]
unlist(strsplit("bHLHE41(bHLH)", '\\('))[1]
unlist(strsplit(unlist(strsplit("Hes7+M0192", '\\('))[1], '+'))[1]
unlist(strsplit(unlist(strsplit("Hes7+M0192", '\\('))[1], '+'))
strsplit(unlist(strsplit("Hes7+M0192", '\\('))[1]
unlist(strsplit("Hes7+M0192", '\\('))[1]
unlist(strsplit("Hes7+M0192", '\\('))[1]
strsplit("Hes7+M0192", "+")
strsplit("Hes7+M0192", "\\+")
unlist(strsplit(unlist(strsplit("Hes7+M0192", '\\('))[1], '\\+'))[1]
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
files <- list.files(path=wk.dir, pattern="*.csv", full.names=FALSE, recursive=FALSE)
i <- 1
i.tb <- read_csv(i)
i.tb <- i.tb %>% mutate(simp_mtf_name = unlist(strsplit(unlist(strsplit(motif_name, '\\('))[1], '\\+'))[1])
i <- files[1]
i.tb <- read_csv(i)
i.tb <- i.tb %>% mutate(simp_mtf_name = unlist(strsplit(unlist(strsplit(motif_name, '\\('))[1], '\\+'))[1])
i.tb$simp_mtf_name
i <- files[1]
i.tb <- read_csv(i)
i.tb <- i.tb %>% mutate(simp_mtf_name = unlist(strsplit(unlist(strsplit( motif_name , '\\('))[1], '\\+'))[1])
i.tb$simp_mtf_name
unlist(strsplit(unlist(strsplit(i.tb$motif_name , '\\('))[1], '\\+'))[1]
i <- files[1]
i.tb <- read_csv(i)
i.tb$motif_name
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
mtf_simp[x] <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
}
mtf_simp
i.tb <- i.tb %>% filter(simp_mtf_name %in% slt.genes)
i.tb$simp_mtf_name <- mtf_simp
i.tb <- i.tb %>% filter(simp_mtf_name %in% slt.genes)
nrow(i.tb)
nrow(i.tb)
slt.genes
slt.genes
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes
i.tb <- i.tb %>% filter(simp_mtf_name %in% slt.genes$GENE)
nrow(i.tb)
slt.genes$GENE
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*.csv", full.names=FALSE, recursive=FALSE)
for (i in files){
i <- files[1]
i.tb <- read_csv(i)
i.tb$motif_name
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
mtf_simp[x] <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
}
i.tb$simp_mtf_name <- mtf_simp
i.tb <- i.tb %>% filter(simp_mtf_name %in% slt.genes$GENE)
}
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*.csv", full.names=FALSE, recursive=FALSE)
i <- files[1]
i.tb <- read_csv(i)
i.tb$motif_name
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
mtf_simp[x] <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
}
i.tb$simp_mtf_name <- mtf_simp
i.tb <- i.tb %>% filter(simp_mtf_name %in% slt.genes$GENE)
slt.genes$GENE
nrow(i.tb)
length(slt.genes$GENE)
i <- files[1]
i.tb <- read_csv(i)
i.tb$motif_name
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
mtf_simp[x] <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
}
i.tb$simp_mtf_name <- mtf_simp
i.tb$simp_mtf_name <- mtf_simp
for (g in slt.genes$GENE){
if (g ! %in% i.tb$simp_mtf_name){
print(g)
}
}
i.tb$simp_mtf_name <- mtf_simp
for (g in slt.genes$GENE){
if (g not %in% i.tb$simp_mtf_name){
print(g)
}
}
i.tb$simp_mtf_name <- mtf_simp
for (g in slt.genes$GENE){
if !(g %in% i.tb$simp_mtf_name){
print(g)
}
}
i.tb$simp_mtf_name <- mtf_simp
for (g in slt.genes$GENE){
if !(g %in% i.tb$simp_mtf_name){
print(g)
}
}
i.tb$simp_mtf_name <- mtf_simp
for (g in slt.genes$GENE){
if (!(g %in% i.tb$simp_mtf_name){
print(g)
}
}
i.tb$simp_mtf_name <- mtf_simp
for (g in slt.genes$GENE){
if (!(g %in% i.tb$simp_mtf_name)){
print(g)
}
}
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- slt.genes %>% mutate(GENE = toupper(GENE))
slt.genes
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- slt.genes %>% mutate(GENE = toupper(GENE))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*.csv", full.names=FALSE, recursive=FALSE)
i <- files[1]
i.tb <- read_csv(i)
i.tb$motif_name
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
new.name <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
new.name <- toupper(new.name)
mtf_simp[x] <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
}
i.tb$simp_mtf_name <- mtf_simp
for (g in slt.genes$GENE){
if (!(g %in% i.tb$simp_mtf_name)){
print(g)
}
}
mtf_simp
i <- files[1]
i.tb <- read_csv(i)
i.tb$motif_name
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
new.name <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
new.name <- toupper(new.name)
mtf_simp[x] <- new.name
}
i.tb$simp_mtf_name <- mtf_simp
mtf_simp
for (g in slt.genes$GENE){
if (!(g %in% i.tb$simp_mtf_name)){
print(g)
}
}
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- slt.genes %>% mutate(GENE = toupper(GENE))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*.csv", full.names=FALSE, recursive=FALSE)
i <- files[1]
i.tb <- read_csv(i)
i.tb$motif_name
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
new.name <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
new.name <- toupper(new.name)
mtf_simp[x] <- new.name
}
i.tb$simp_mtf_name <- mtf_simp
for (g in slt.genes$GENE){
if (!(g %in% i.tb$simp_mtf_name)){
print(g)
}
}
i
i.tb$motif_name
i <- files[1]
out.name <- gsub(".csv", "", i)
i <- files[1]
out.name <- gsub(".csv", "", i)
out.name <- paste(out.name, "_flt.csv", sep="")
out.name
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- slt.genes %>% mutate(GENE = toupper(GENE))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*.csv", full.names=FALSE, recursive=FALSE)
for (i in files){
out.name <- gsub(".csv", "", i)
out.name <- paste(out.name, "_flt.csv", sep="")
i.tb <- read_csv(i)
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
new.name <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
new.name <- toupper(new.name)
mtf_simp[x] <- new.name
}
i.tb$simp_mtf_name <- mtf_simp
write_csv(i.tb, out.name)
}
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- slt.genes %>% mutate(GENE = toupper(GENE))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*.csv", full.names=FALSE, recursive=FALSE)
for (i in files){
out.name <- gsub(".csv", "", i)
out.name <- paste(out.name, "_flt.csv", sep="")
i.tb <- read_csv(i)
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
new.name <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
new.name <- toupper(new.name)
mtf_simp[x] <- new.name
}
i.tb$simp_mtf_name <- mtf_simp
i.tb <- i.tb %>%  filter(simp_mtf_name %in% slt.genes$GENE)
write_csv(i.tb, out.name)
}
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- slt.genes %>% mutate(GENE = toupper(GENE))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*rmdup.csv", full.names=FALSE, recursive=FALSE)
for (i in files){
out.name <- gsub(".csv", "", i)
out.name <- paste(out.name, "_flt.csv", sep="")
i.tb <- read_csv(i)
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
new.name <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
new.name <- toupper(new.name)
mtf_simp[x] <- new.name
}
i.tb$simp_mtf_name <- mtf_simp
i.tb <- i.tb %>%  filter(simp_mtf_name %in% slt.genes$GENE)
write_csv(i.tb, out.name)
plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"))
}
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- slt.genes %>% mutate(GENE = toupper(GENE))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*rmdup.csv", full.names=FALSE, recursive=FALSE)
i <- files[1]
out.name <- gsub(".csv", "", i)
out.name <- paste(out.name, "_flt.csv", sep="")
i.tb <- read_csv(i)
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
new.name <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
new.name <- toupper(new.name)
mtf_simp[x] <- new.name
}
i.tb$simp_mtf_name <- mtf_simp
i.tb <- i.tb %>%  filter(simp_mtf_name %in% slt.genes$GENE)
write_csv(i.tb, out.name)
plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"))
slt.genes <- read_table("/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/z_Figures/Heatmap Gene List for ATAC-Seq.txt")
slt.genes <- slt.genes %>% mutate(GENE = toupper(GENE))
wk.dir <- "/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/2_compiled_pctg_dupr_slt"
setwd(wk.dir)
files <- list.files(path=wk.dir, pattern="*rmdup.csv", full.names=FALSE, recursive=FALSE)
for (i in files){
i <- files[1]
out.name <- gsub(".csv", "", i)
out.name <- paste(out.name, "_flt.csv", sep="")
i.tb <- read_csv(i)
mtf_simp <- character(length(i.tb$motif_name))
for (x in c(1:length(mtf_simp))){
new.name <- unlist(strsplit(unlist(strsplit(i.tb$motif_name[x] , '\\('))[1], '\\+'))[1]
new.name <- toupper(new.name)
mtf_simp[x] <- new.name
}
i.tb$simp_mtf_name <- mtf_simp
i.tb <- i.tb %>%  filter(simp_mtf_name %in% slt.genes$GENE)
i.tb$simp_mtf_name <- NULL
write_csv(i.tb, out.name)
plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"))
}
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
i <- files[1]
i
if ("up.srt" %in% i) {
#plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"), 5,15)
print(i)
}
else if ("dn.srt" %in% i) {
#plot_heatmap(out.name, c("white",brewer.pal(5,"YlGnBu"), "black"), 5,15)
print("not")
}
if ("up.srt" %in% i) {
#plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"), 5,15)
print(i)
}
else if ("dn.srt" %in% i) {
#plot_heatmap(out.name, c("white",brewer.pal(5,"YlGnBu"), "black"), 5,15)
print("not")
}
if ("up.srt" %in% i) {
#plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"), 5,15)
print(i)
}
else if ("dn.srt" %in% i) {
print("not") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlGnBu"), "black"), 5,15)
}
if ("up.srt" %in% i) {
print(i) #plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"), 5,15)
}
else if ("dn.srt" %in% i) {
print("not") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlGnBu"), "black"), 5,15)
}
if ("up.srt" %in% i) {
print("yes") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"), 5,15)
}
else if ("dn.srt" %in% i) {
print("no") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlGnBu"), "black"), 5,15)
}
if ("up.srt" %in% i) {
print("yes") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"), 5,15)
}
if ("up.srt" %in% i) {
print("yes") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"), 5,15)
} else if ("dn.srt" %in% i) {
print("no") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlGnBu"), "black"), 5,15)
}
i
i
if (grepl("up.srt", i)) {
print("yes") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlOrRd"), "black"), 5,15)
} else if (grepl("dn.srt", i)) {
print("no") #plot_heatmap(out.name, c("white",brewer.pal(5,"YlGnBu"), "black"), 5,15)
}
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Yolanda/jycATAC/JYC_DataAnalysis/x_Figures_plottingCodes/0_motifHeatMap_genegroup/plot_motifHeatMap_TFenrichment_combined_motifs.r')
