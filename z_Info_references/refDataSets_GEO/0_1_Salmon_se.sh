#!/bin/bash
#PBS -l nodes=1:ppn=16
#PBS -l mem=8gb
#PBS -t 0-154

INDIR=/gpfs/home/hdiao/jycATAC/GEO_RNA
cd $INDIR

##### Load salmon
module load salmon

##### Names
sp_names=(SRR6246592 SRR6246594 SRR6246595 SRR6246596 SRR6246597 SRR6246598 SRR6246599 SRR6246590 SRR6246591 SRR6246600 SRR6246601 SRR6246602 SRR6246603 SRR6246604 SRR6246607 SRR6246608 SRR6246609 SRR6246610 SRR6246611 SRR6246612 SRR6246613 SRR6246593 SRR6246605 SRR6246606 SRR6246614 SRR6246615 SRR6246616 SRR6246617 SRR6246618 SRR6246619 SRR6246620 SRR6246621 SRR6246622 SRR6246623 SRR6246624 SRR6246625 SRR6246626 SRR6246627 SRR6246628 SRR6246629 SRR6246630 SRR6246631 SRR6246632 SRR6246633 SRR6246634 SRR6246635 SRR6246636 SRR6246637 SRR6246638 SRR6246639 SRR6246640 SRR6246641 SRR6246642 SRR6246643 SRR6246644 SRR6246645 SRR6246647 SRR6246648 SRR6246649 SRR6246650 SRR6246651 SRR6246652 SRR6246653 SRR6246654 SRR6246655 SRR6246656 SRR6246657 SRR6246658 SRR6246659 SRR6246660 SRR6246661 SRR6246662 SRR6246663 SRR6246664 SRR6246665 SRR6246666 SRR6246667 SRR6246668 SRR6246669 SRR6246670 SRR6246671 SRR6246672 SRR6246673 SRR6246674 SRR6246675 SRR6246676 SRR6246677 SRR6246678 SRR6246679 SRR6246680 SRR6246681 SRR6246682 SRR6246683 SRR6246684 SRR6246685 SRR6246686 SRR6246687 SRR6246688 SRR6246689 SRR6246690 SRR6246691 SRR6246692 SRR6246693 SRR6246694 SRR6246695 SRR6246696 SRR6246697 SRR6246698 SRR6246699 SRR6246700 SRR6246701 SRR6246702 SRR6246703 SRR6246704 SRR6246705 SRR6246706 SRR6246707 SRR6246708 SRR6246709 SRR6246710 SRR6246711 SRR6246712 SRR6246713 SRR6246714 SRR6246715 SRR6246716 SRR6246717 SRR6246718 SRR6246719 SRR6246720 SRR6246721 SRR6246722 SRR6246723 SRR6246724 SRR6248841 SRR6248842 SRR6248843 SRR6248844 SRR6248845 SRR6248846 SRR6248847 SRR6248848 SRR6248849 SRR6248850 SRR6248851 SRR6248852 SRR6248853 SRR6248854 SRR6248855 SRR6248856 SRR6248857 SRR6248858 SRR6248859 SRR6248861 SRR6248860)

##### Run salmon quant
fastq_name=$INDIR/${sp_names[$PBS_ARRAYID]}_1.fastq
out_name=$INDIR/${sp_names[$PBS_ARRAYID]}
#---- Use Ensembl mm10
mm10_index="/gpfs/home/hdiao/resources/Transcript/Ensembl_5_17_mm10_qusai_salmon_index"
salmon quant -i $mm10_index -l A -p 16 -r $fastq_name -o $out_name
#---- If quant complete, delete fastq file
quant_file=$INDIR/${sp_names[$PBS_ARRAYID]}/quant.sf
quant_file_size=$(stat --printf=%s $quant_file)
if (( $quant_file_size > 100 ))
then
	rm $fastq_name
fi


