#################### motifHeatMap ####################
# Author: Huitian (Yolanda) Diao
# Nov 9th , 2018
# Dependencies:
# 1. Data prep <- prep_motifHeatMap.py <- fc_motifHeatMap.py
# 2. Motif finding <- Homer
# etc...
#################### Imports ####################
library(pheatmap)
library(RColorBrewer)
library(viridis)
#################### Self-defined functions ####################
fnameNoPathPdf <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "new.pdf", namex)
return(namex)
}
fnameNoPath <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "", namex)
return(namex)
}
save_pheatmap_pdf <- function(x, filename, width=7, height=7) {
stopifnot(!missing(x))
stopifnot(!missing(filename))
pdf(filename, width=width, height=height)
grid::grid.newpage()
grid::grid.draw(x$gtable)
dev.off()
}
setRnames <- function(tabx){
row.names(tabx) <- unlist(tabx[,1])
head(tabx)
tabx[,1] <- NULL
return(tabx)
}
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive_pval-0.05_up-sig_c10_heatmap_byfamily.csv"
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(0, 80, by=5)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, color = col.pal, border_color = "white",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 12)
}
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(dk.dir)
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "orange", "red"))
infile <- "vsNaive-dn_all_sig_motifs_c25_byfamily.csv"
col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(0, 80, by=5)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, color = col.pal, border_color = "white",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 12)
myColor
length(myColor)
length(myColor)
length(myBreaks)
#################### motifHeatMap ####################
# Author: Huitian (Yolanda) Diao
# Nov 9th , 2018
# Dependencies:
# 1. Data prep <- prep_motifHeatMap.py <- fc_motifHeatMap.py
# 2. Motif finding <- Homer
# etc...
#################### Imports ####################
library(pheatmap)
library(RColorBrewer)
library(viridis)
#################### Self-defined functions ####################
fnameNoPathPdf <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "new.pdf", namex)
return(namex)
}
fnameNoPath <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "", namex)
return(namex)
}
save_pheatmap_pdf <- function(x, filename, width=7, height=7) {
stopifnot(!missing(x))
stopifnot(!missing(filename))
pdf(filename, width=width, height=height)
grid::grid.newpage()
grid::grid.draw(x$gtable)
dev.off()
}
setRnames <- function(tabx){
row.names(tabx) <- unlist(tabx[,1])
head(tabx)
tabx[,1] <- NULL
return(tabx)
}
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs_c25_byfamily.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(0, 100, by=5)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "white",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 12)
}
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "orange", "red", "firebrick"))
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs_c25_byfamily.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(0, 100, by=2)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "white",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 12)
}
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "orange", "orangered", "red", "firebrick"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "orange", "red", "purple"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "orange", "red", "purple"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "orangered", "red", "red4"))
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "yellow", "orangered", "red", "red4"))
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "khaki1", "orangered", "red", "red4"))
#################### motifHeatMap ####################
# Author: Huitian (Yolanda) Diao
# Nov 9th , 2018
# Dependencies:
# 1. Data prep <- prep_motifHeatMap.py <- fc_motifHeatMap.py
# 2. Motif finding <- Homer
# etc...
#################### Imports ####################
library(pheatmap)
library(RColorBrewer)
library(viridis)
#################### Self-defined functions ####################
fnameNoPathPdf <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "new.pdf", namex)
return(namex)
}
fnameNoPath <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "", namex)
return(namex)
}
save_pheatmap_pdf <- function(x, filename, width=7, height=7) {
stopifnot(!missing(x))
stopifnot(!missing(filename))
pdf(filename, width=width, height=height)
grid::grid.newpage()
grid::grid.draw(x$gtable)
dev.off()
}
setRnames <- function(tabx){
row.names(tabx) <- unlist(tabx[,1])
head(tabx)
tabx[,1] <- NULL
return(tabx)
}
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs_c25_byfamily.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(0, 80, by=1)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "white",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 12)
}
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "khaki1", "orangered", "red", "red4"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "yellow", "orangered", "red", "red4"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("white", "yellow", "orangered", "red", "red4"))
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "yellow", "orangered", "red", "red4"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orangered", "red", "red4"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", YlOrRd(5))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", brewer.pal(5,"YlOrRd"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orangered", "red", "red4"))
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orangered", "red", "red4", "firebrick4"))
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orangered", "red", "red4"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orange", "red", "red4"))
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orange", "orangered", "red4"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orange", "red", "darkred"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orange", "red", "darkred", "black"))
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
#################### motifHeatMap ####################
# Author: Huitian (Yolanda) Diao
# Nov 9th , 2018
# Dependencies:
# 1. Data prep <- prep_motifHeatMap.py <- fc_motifHeatMap.py
# 2. Motif finding <- Homer
# etc...
#################### Imports ####################
library(pheatmap)
library(RColorBrewer)
library(viridis)
#################### Self-defined functions ####################
fnameNoPathPdf <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "new.pdf", namex)
return(namex)
}
fnameNoPath <- function(namex){
namex.vec <- unlist(strsplit(namex, "/"))
namex <- tail(namex.vec, n=1)
namex <- gsub(".csv", "", namex)
return(namex)
}
save_pheatmap_pdf <- function(x, filename, width=7, height=7) {
stopifnot(!missing(x))
stopifnot(!missing(filename))
pdf(filename, width=width, height=height)
grid::grid.newpage()
grid::grid.draw(x$gtable)
dev.off()
}
setRnames <- function(tabx){
row.names(tabx) <- unlist(tabx[,1])
head(tabx)
tabx[,1] <- NULL
return(tabx)
}
plot_heatmap <- function(infile, col.pal){
#infile <- "vsNaive-dn_all_sig_motifs_c25_byfamily.csv"
#col.pal <- c("lightyellow", "orange", "red")
outname <- fnameNoPathPdf(infile)
intab <- read.csv(infile)
intab <- setRnames(intab)
myBreaks <- seq(0, 80, by=1)
myColor <- colorRampPalette(col.pal)(length(myBreaks))
heat.map <- pheatmap(mat = intab, border_color = "white",
color=myColor, breaks=myBreaks,
show_rownames = TRUE, show_colnames = TRUE, fontsize = 6,
cellwidth = 9, cellheight = 9, main = infile,
cluster_cols = FALSE, cluster_rows = FALSE)
save_pheatmap_pdf(heat.map, outname, 6, 12)
}
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orange", "red", "darkred", "black"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat1", "orange", "red", "darkred", "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "palegreen", "green1", "green4", "blue", "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("lightyellow", "wheat", "green1", "green4", "blue", "black"))
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs_c25_byfamily.csv", brewer.pal(9,"YlOrRd"))
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", brewer.pal(9,"YlGnBu"))
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs_c25_byfamily.csv", c(brewer.pal(9,"YlOrRd"), "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c(brewer.pal(9,"YlGnBu"), "black"))
#################### Main ####################
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs_c25_byfamily.csv", c("white",brewer.pal(9,"YlOrRd"), "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("white",brewer.pal(9,"YlGnBu"), "black"))
wk.dir <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/1_combined_motifs/Percentage_Heatmaps"
setwd(wk.dir)
plot_heatmap("vsNaive-up_all_sig_motifs_c25_byfamily.csv", c("white",brewer.pal(5,"YlOrRd"), "black"))
plot_heatmap("vsNaive-dn_all_sig_motifs_c25_byfamily.csv", c("white",brewer.pal(5,"YlGnBu"), "black"))
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
