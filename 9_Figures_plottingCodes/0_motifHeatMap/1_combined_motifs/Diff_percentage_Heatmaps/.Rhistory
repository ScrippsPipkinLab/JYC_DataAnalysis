x.name
#--- Figure title
fig.title <- "Gene nearby \n"
atac.name <- file.name.no.path.vec[length(file.name.no.path.vec) - 1]
TF.full <- unlist(strsplit(atac.name, "\\."))[1]
fig.title <- paste(fig.title, TF.full, " motifs \n in regions ", sep="")
updn <- tail(unlist(strsplit(atac.name, "--")), n=1)
updn <- gsub("dn", "less accessible in", updn)
updn <- gsub("up", "more accessible in", updn)
fig.title <- paste(fig.title, updn, sep="")
atat.comparison <- tail(unlist(strsplit(atac.name, "\\.")), n=1)
atat.comparison <- unlist(strsplit(atat.comparison, "--"))[1]
g1 <- unlist(strsplit(atat.comparison, "_vs_"))[1]
g2 <- unlist(strsplit(atat.comparison, "_vs_"))[2]
fig.title <- paste(fig.title, "\n", g1, " than ", g2, sep="")
fig.title
in.df <- read_csv(in.file)
in.df <- in.df[order(-in.df$log2FC), ]
in.df["G1sqrt"] <- sqrt(in.df$G1)
in.df["Ranks"] <- factor(c(1:nrow(in.df)))
in.df$geneName <- factor(in.df$geneName, levels = in.df$geneName)
dot.col <- c()
dot.size <- c()
dot.name <- c()
for (x in c(1:length(in.df$geneName))){
genex <- as.character(unlist(in.df$geneName))[x]
tpmsqrtx <- unlist(in.df$G1sqrt)[x]
if (genex %in% ref.list1){
dot.col <- c(dot.col, "red")
dot.size <- c(dot.size, tpmsqrtx)
dot.name <- c(dot.name, genex)
}
else if (genex %in% ref.list2){
dot.col <- c(dot.col, "blue")
dot.size <- c(dot.size, tpmsqrtx)
dot.name <- c(dot.name, genex)
}
else {
dot.col <- c(dot.col, "grey")
dot.size <- c(dot.size, 0)
dot.name <- c(dot.name, "")
}
}
in.df["dotcol"] <- dot.col
in.df["dotsize"] <- dot.size
in.df["dotname"] <- dot.name
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
scale_x_continuous(limits = c(-8, 8)) +
xlab(x.name) + labs(title = fig.title) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5), scale_x_reverse())
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
scale_x_continuous(limits = c(-8, 8)) +
xlab(x.name) + labs(title = fig.title) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
scale_x_continuous(limits = c(-8, 8)) +
xlab(x.name) + labs(title = fig.title) +
scale_x_reverse() +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_reverse() +
scale_x_continuous(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_reverse(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_continuous(limits = c(8, -8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_continuous(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
x.name
in.file.vec <- unlist(strsplit(in.file, "/"))
file.name.no.path <- tail(in.file.vec, n=1)
file.name.no.path.vec <- unlist(strsplit(file.name.no.path, "__"))
RNA.comparison <- tail( file.name.no.path.vec, n=1)
RNA.comparison <- gsub("RNA.", "", RNA.comparison)
RNA.comparison <- gsub(".csv", "", RNA.comparison)
RNA.comparison <- gsub("\\.", " v.s. ", RNA.comparison)
R1 <- unlist(strsplit(RNA.comparison, " v.s. "))[1]
R2 <- unlist(strsplit(RNA.comparison, " v.s. "))[2]
x.name <- paste(RNA.comparison, "log2FC", sep=" ")
x.name <- paste(x.name, "(postivie value: ", R1, ">", R2, ")", sep="")
x.name
in.file.vec <- unlist(strsplit(in.file, "/"))
file.name.no.path <- tail(in.file.vec, n=1)
file.name.no.path.vec <- unlist(strsplit(file.name.no.path, "__"))
RNA.comparison <- tail( file.name.no.path.vec, n=1)
RNA.comparison <- gsub("RNA.", "", RNA.comparison)
RNA.comparison <- gsub(".csv", "", RNA.comparison)
RNA.comparison <- gsub("\\.", " v.s. ", RNA.comparison)
R1 <- unlist(strsplit(RNA.comparison, " v.s. "))[1]
R2 <- unlist(strsplit(RNA.comparison, " v.s. "))[2]
x.name <- paste(RNA.comparison, "log2FC", sep=" ")
x.name <- paste(x.name, "  (postivie value: ", R1, ">", R2, ")", sep="")
x.name
in.file.vec <- unlist(strsplit(in.file, "/"))
file.name.no.path <- tail(in.file.vec, n=1)
file.name.no.path.vec <- unlist(strsplit(file.name.no.path, "__"))
RNA.comparison <- tail( file.name.no.path.vec, n=1)
RNA.comparison <- gsub("RNA.", "", RNA.comparison)
RNA.comparison <- gsub(".csv", "", RNA.comparison)
RNA.comparison <- gsub("\\.", " v.s. ", RNA.comparison)
R1 <- unlist(strsplit(RNA.comparison, " v.s. "))[1]
R2 <- unlist(strsplit(RNA.comparison, " v.s. "))[2]
x.name <- paste(RNA.comparison, "log2FC", sep=" ")
x.name <- paste(x.name, "  (postivie value: ", R1, " > ", R2, ")", sep="")
x.name
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_continuous(limits = c(-8, 8)) +
scale_color_manual(labels = c("Tfh associated", "Th1 associated"), values = c("blue", "red")) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_continuous(limits = c(-8, 8)) +
scale_color_manual(labels = c("Tfh associated", "Th1 associated"), values = c("blue", "red")) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_continuous(limits = c(-8, 8)) +
geom_text(aes(0, 0, label="Tfh associate", color="red")) +
geom_text(aes(0, 0, label="Th1 associate", color="blue")) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_continuous(limits = c(-8, 8)) +
geom_text(aes(5, 5, label="Tfh associate", color="red")) +
geom_text(aes(5, 4, label="Th1 associate", color="blue")) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title) +
scale_x_continuous(limits = c(-8, 8)) +
geom_text(aes(5, 100, label="Tfh associate", color="red")) +
geom_text(aes(5, 4, label="Th1 associate", color="blue")) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title, subtitle = "Highlighted Tfh(red) / Th1(blue) associated genes") +
scale_x_continuous(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5))
bbplot
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title, subtitle = "Highlighted Tfh(red) / Th1(blue) associated genes") +
scale_x_continuous(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title, subtitle = "Highlighted Tfh(red) / Th1(blue) associated genes") +
scale_x_continuous(limits = c(-8, 8)) +
guides(fill=guide_legend(title=paste(g1," TPM", sep=""))) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title, subtitle = "Highlighted Tfh(red) / Th1(blue) associated genes", shape=paste(g1, " TPM", sep="")) +
scale_x_continuous(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title, subtitle = "Highlighted Tfh(red) / Th1(blue) associated genes", size=paste(g1, " TPM", sep="")) +
scale_x_continuous(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
bbplot
in.file <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/plots/RUNX-AML_Runt.WT_Tfh_vs_WT_Th1--dn__RNA.WT_TFH.WT_TH1.csv"
reflists <- c("/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/TFH_associated.csv",
"/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/TH1_associated.csv")
reflistnames <- c("Tfh associated", "Th1 associated")
ref.list1 <- unlist(read_csv(reflists[1])$GeneName)
ref.list2 <- unlist(read_csv(reflists[2])$GeneName)
#--- Out png name
in.file.vec <- unlist(strsplit(in.file, "/"))
file.name.no.path <- tail(in.file.vec, n=1)
out.name <- gsub(".csv", ".png", file.name.no.path)
out.name
in.file <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/plots/RUNX-AML_Runt.WT_Tfh_vs_WT_Th1--dn__RNA.WT_TFH.WT_TH1.csv"
reflists <- c("/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/TFH_associated.csv",
"/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/TH1_associated.csv")
reflistnames <- c("Tfh associated", "Th1 associated")
ref.list1 <- unlist(read_csv(reflists[1])$GeneName)
ref.list2 <- unlist(read_csv(reflists[2])$GeneName)
#--- Out png name
out.name <- gsub(".csv", ".png", in.file)
out.name
ggsave(bbplot, out.name)
ggsave(out.name, bbplot, device="png")
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title, subtitle = "Highlighted Tfh(red) / Th1(blue) associated genes", size=paste(g1, " TPM", sep="")) +
scale_x_continuous(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
#--- Save
ggsave(out.name, bbplot, device="png", width = 20, height = 20)
ggsave(out.name, bbplot, device="png", width = 7, height = 7, dpi=320)
in.file <- "/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/plots/RUNX-AML_Runt.WT_Tfh_vs_WT_Th1--dn__RNA.WT_TFH.WT_TH1.csv"
reflists <- c("/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/TFH_associated.csv",
"/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/1_TFcontrolledRegionPathway/TH1_associated.csv")
reflistnames <- c("Tfh associated", "Th1 associated")
ref.list1 <- unlist(read_csv(reflists[1])$GeneName)
ref.list2 <- unlist(read_csv(reflists[2])$GeneName)
#--- Out png name
out.name <- gsub(".csv", ".png", in.file)
#--- X lab name
in.file.vec <- unlist(strsplit(in.file, "/"))
file.name.no.path <- tail(in.file.vec, n=1)
file.name.no.path.vec <- unlist(strsplit(file.name.no.path, "__"))
RNA.comparison <- tail( file.name.no.path.vec, n=1)
RNA.comparison <- gsub("RNA.", "", RNA.comparison)
RNA.comparison <- gsub(".csv", "", RNA.comparison)
RNA.comparison <- gsub("\\.", " v.s. ", RNA.comparison)
R1 <- unlist(strsplit(RNA.comparison, " v.s. "))[1]
R2 <- unlist(strsplit(RNA.comparison, " v.s. "))[2]
x.name <- paste(RNA.comparison, "log2FC", sep=" ")
x.name <- paste(x.name, "  (postivie value: ", R1, " > ", R2, ")", sep="")
x.name
#--- Figure title
fig.title <- "Genes nearby \n"
atac.name <- file.name.no.path.vec[length(file.name.no.path.vec) - 1]
TF.full <- unlist(strsplit(atac.name, "\\."))[1]
fig.title <- paste(fig.title, TF.full, " motifs \n in regions ", sep="")
updn <- tail(unlist(strsplit(atac.name, "--")), n=1)
updn <- gsub("dn", "less accessible in", updn)
updn <- gsub("up", "more accessible in", updn)
fig.title <- paste(fig.title, updn, sep="")
atat.comparison <- tail(unlist(strsplit(atac.name, "\\.")), n=1)
atat.comparison <- unlist(strsplit(atat.comparison, "--"))[1]
g1 <- unlist(strsplit(atat.comparison, "_vs_"))[1]
g2 <- unlist(strsplit(atat.comparison, "_vs_"))[2]
fig.title <- paste(fig.title, "\n", g1, " than ", g2, sep="")
in.df <- read_csv(in.file)
in.df <- in.df[order(-in.df$log2FC), ]
in.df["G1sqrt"] <- sqrt(in.df$G1)
in.df["Ranks"] <- factor(c(1:nrow(in.df)))
in.df$geneName <- factor(in.df$geneName, levels = in.df$geneName)
dot.col <- c()
dot.size <- c()
dot.name <- c()
for (x in c(1:length(in.df$geneName))){
genex <- as.character(unlist(in.df$geneName))[x]
tpmsqrtx <- unlist(in.df$G1sqrt)[x]
if (genex %in% ref.list1){
dot.col <- c(dot.col, "red")
dot.size <- c(dot.size, tpmsqrtx)
dot.name <- c(dot.name, genex)
}
else if (genex %in% ref.list2){
dot.col <- c(dot.col, "blue")
dot.size <- c(dot.size, tpmsqrtx)
dot.name <- c(dot.name, genex)
}
else {
dot.col <- c(dot.col, "grey")
dot.size <- c(dot.size, 0)
dot.name <- c(dot.name, "")
}
}
in.df["dotcol"] <- dot.col
in.df["dotsize"] <- dot.size
in.df["dotname"] <- dot.name
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks)) +
geom_point(color = "grey", shape=20, size = 1)
bbplot
bbplot <- ggplot(in.df, aes(x=in.df$log2FC, y=in.df$Ranks, size=dot.size)) +
geom_point(alpha=0.7, color = dot.col, shape=20) +
geom_vline(xintercept=0, colour="black") +
geom_vline(xintercept=2, colour="grey", size=0.1) +
geom_vline(xintercept=-2, colour="grey", size=0.1) +
xlab(x.name) + labs(title = fig.title, subtitle = "Highlighted Tfh(red) / Th1(blue) associated genes", size=paste(g1, " TPM", sep="")) +
scale_x_continuous(limits = c(-8, 8)) +
theme(axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.title.y=element_blank(),
panel.background = element_rect(fill = "white", linetype = "solid"),
panel.grid.major = element_line(size = 0.1, linetype = 'solid', colour = "grey"),
plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
bbplot <- bbplot +
geom_text_repel(aes(label=in.df$dotname), alpha=0.8 )
#--- Save
ggsave(out.name, bbplot, device="png", width = 7, height = 7, dpi=320)
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichment_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
source('/Volumes/Huitian/jycATAC/9_Figures_plottingCodes/0_motifHeatMap/plot_motifHeatMap_TFenrichmentDiff_combined_motifs.r')
