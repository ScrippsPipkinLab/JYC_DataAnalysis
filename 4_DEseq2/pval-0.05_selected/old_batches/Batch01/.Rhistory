setwd("/Users/yolandatiao/Desktop/jycATAC/tfh")
DKO.1 <- read.table("DKO_Tfh_rep1_Tn5.srt.tpm", sep = '\t',header = FALSE)
DKO.1 <- read.table("DKO_Tfh_rep1_Tn5.srt.tpm", sep = '\t',header = FALSE)
DKO.2 <- read.table("DKO_Tfh_rep2_Tn5.srt.tpm", sep = '\t',header = FALSE)
DKO.3 <- read.table("DKO_Tfh_rep3_Tn5.srt.tpm", sep = '\t',header = FALSE)
Prdm1KO.1 <- read.table("Prdm1KO_Tfh_rep1_Tn5.srt.tpm", sep = '\t',header = FALSE)
Prdm1KO.2 <- read.table("Prdm1KO_Tfh_rep2_Tn5.srt.tpm", sep = '\t',header = FALSE)
Prdm1KO.3 <- read.table("Prdm1KO_Tfh_rep3_Tn5.srt.tpm", sep = '\t',header = FALSE)
WT.1 <- read.table("WT_Tfh_rep1_Tn5.srt.tpm", sep = '\t',header = FALSE)
WT.2 <- read.table("WT_Tfh_rep2_Tn5.srt.tpm", sep = '\t',header = FALSE)
WT.3 <- read.table("WT_Tfh_rep3_Tn5.srt.tpm", sep = '\t',header = FALSE)
STAT4WT.1 <- read.table("STAT4_WT_Tfh-1_Tn5.srt.tpm", sep = '\t',header = FALSE)
STAT4WT.2 <- read.table("STAT4_WT_Tfh-2_Tn5.srt.tpm", sep = '\t',header = FALSE)
STAT4KO.1 <- read.table("STAT4_KO_Tfh-1_Tn5.srt.tpm", sep = '\t',header = FALSE)
STAT4KO.2 <- read.table("STAT4_KO_Tfh-1_Tn5.srt.tpm", sep = '\t',header = FALSE)
head(DKO.1)
all.df <- cbind(DKO.1, DKO.2$V2, DKO.3$V2,
Prdm1KO.1$V2, Prdm1KO.2$V2, Prdm1KO.3$V2,
WT.1$V2,  WT.2$V2,  WT.3$V2,
STAT4WT.1$V2, STAT4WT.2$V2, STAT4KO.1$V2, STAT4KO.2$V2)
colnames(all.df) <- c(DKO.1, DKO.2, DKO.3,
Prdm1KO.1, Prdm1KO.2, Prdm1KO.3,
WT.1,  WT.2,  WT.3,
STAT4WT.1, STAT4WT.2, STAT4KO.1, STAT4KO.2)
colnames(all.df) <- c("DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3", "WT_1", " WT_2", " WT_3", "STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2")
write.csv(all.df, file="all.df.csv")
all.df[1]
all.df[,1]
all.df[1,]
all.df[1,][1:]
all.df[1,][c(1:13)]
colnames(all.df) <- c("PeakName", "DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3", "WT_1", " WT_2", " WT_3", "STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2")
write.csv(all.df, file="all.df.csv")
all.df[1,][c(1:13)]
all.df[1,][c(1:14)]
all.df[1,][c(1:15)]
all.df[1,][c(1:14)]
all.df[1,][c(2:14)]
max(all.df[1,][c(2:14)])
length(all.df)
nrow(all.df)
for i in c(1:5){
print i
}
for (i in c(1:5)){
print i
}
for (i in c(1:5)){
print(i)
}
max.num <- numeric(nrow(all.df))
max.num <- numeric(nrow(all.df))
for (i in c(1:nrow(all.df))){
max.num[i] <- max(all.df[i,][c(2:14)])
}
head(max.num)
all.df <- cbind(all.df, max.num)
head(all.df)
all.df.2 <- subset(all.df, all.df$max.num > 2)
dim(all.df)
dim(all.df.2)
all.df.5 <- subset(all.df, all.df$max.num > 5)
dim(all.df)
dim(all.df.2)
dim(all.df.5)
write.csv(all.df.5, file="all.df.c5.csv")
write.csv(all.df, file="all.df.csv", row.names=FALSE)
write.csv(all.df.5, file="all.df.c5.csv", row.names=FALSE)
all.df.dko.wt <- all.df[c("PeakName", "DKO_1", "DKO_2", "DKO_3", "WT_1", " WT_2", " WT_3")]
head(all.df.dko.wt)
all.df.dko.wt <- all.df[c("PeakName", "DKO_1", "DKO_2", "DKO_3", "WT_1", " WT_2", " WT_3")]
all.df.dko.prdm1 <- all.df[c("PeakName", "DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2")]
all.df.prdm1.wt <- all.df[c("PeakName", "Prdm1KO_1", "Prdm1KO_2", "WT_1", " WT_2", " WT_3")]
all.df.stat4wt.wt <- all.df[c("PeakName", "WT_1", " WT_2", " WT_3", "STAT4WT_1", "STAT4WT_2")]
all.df.dko.wt <- all.df[c("PeakName", "DKO_1", "DKO_2", "DKO_3", "WT_1", " WT_2", " WT_3", "max.num")]
all.df.dko.prdm1 <- all.df[c("PeakName", "DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2", "max.num")]
all.df.prdm1.wt <- all.df[c("PeakName", "Prdm1KO_1", "Prdm1KO_2", "WT_1", " WT_2", " WT_3", "max.num")]
all.df.stat4wt.wt <- all.df[c("PeakName", "WT_1", " WT_2", " WT_3", "STAT4WT_1", "STAT4WT_2", "max.num")]
all.df.dko.wt.5 <- subset(all.df.dko.wt, all.df.dko.wt$max.num > 5)
dim(all.df.dko.wt.5)
dim(all.df.dko.wt)
dim(all.df.5)
dim(all.df.dko.wt.5)
rownames(all.df.5) <- all.df.5[,1]
all.df.5[,1] <- NULL
head(all.df.5)
all.df.5["max.num"] <- NULL
head(all.df.5)
dim(all.df.5)
library(DESeq2)
all.df.5.DES<-DESeqDataSetFromMatrix(countData = all.df.5, colData = all.df.5.design,design = ~ condition)
all.df.5.DES<-DESeq(all.df.5.DES)
all.df.5.design <-data.frame(row.names=c("DKO_1", "DKO_2", "DKO_3",
"Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3",
"WT_1", " WT_2", " WT_3",
"STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2"),
condition=as.factor(c("DKO", "DKO", "DKO",
"Prdm1KO", "Prdm1KO", "Prdm1KO",
"WT", " WT", " WT",
"STAT4WT", "STAT4WT", "STAT4KO", "STAT4KO")) )
all.df.5.DES<-DESeqDataSetFromMatrix(countData = all.df.5, colData = all.df.5.design,design = ~ condition)
all.df.5.DES<-DESeq(all.df.5.DES)
all.df.5.design <-data.frame(row.names=c("DKO_1", "DKO_2", "DKO_3",
"Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3",
"WT_1", " WT_2", " WT_3",
"STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2"),
condition=as.factor(c("DKO", "DKO", "DKO",
"Prdm1KO", "Prdm1KO", "Prdm1KO",
"WT", " WT", " WT",
"STAT4WT", "STAT4WT", "STAT4KO", "STAT4KO")) )
all.df.5.DES<-DESeqDataSetFromMatrix(countData = all.df.5, colData = all.df.5.design,design = ~ condition)
head(all.df.5)
all.df.5.design
all.df.5.design <-data.frame(row.names=c("DKO_1", "DKO_2", "DKO_3",
"Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3",
"WT_1", "WT_2", "WT_3",
"STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2"),
condition=as.factor(c("DKO", "DKO", "DKO",
"Prdm1KO", "Prdm1KO", "Prdm1KO",
"WT", " WT", " WT",
"STAT4WT", "STAT4WT", "STAT4KO", "STAT4KO")) )
all.df.5.design
all.df.5.DES<-DESeqDataSetFromMatrix(countData = all.df.5, colData = all.df.5.design,design = ~ condition)
colnames(all.df.5) <- c("PeakName", "DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3", "WT_1", "WT_2", "WT_3", "STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2")
colnames(all.df.5) <- c("DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3", "WT_1", "WT_2", "WT_3", "STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2")
all.df.5.design <-data.frame(row.names=c("DKO_1", "DKO_2", "DKO_3",
"Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3",
"WT_1", "WT_2", "WT_3",
"STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2"),
condition=as.factor(c("DKO", "DKO", "DKO",
"Prdm1KO", "Prdm1KO", "Prdm1KO",
"WT", " WT", " WT",
"STAT4WT", "STAT4WT", "STAT4KO", "STAT4KO")) )
all.df.5.design
all.df.5.DES<-DESeqDataSetFromMatrix(countData = all.df.5, colData = all.df.5.design,design = ~ condition)
all.df.5.design <-data.frame(row.names=c("DKO_1", "DKO_2", "DKO_3",
"Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3",
"WT_1", "WT_2", "WT_3",
"STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2"),
condition=as.factor(c("DKO", "DKO", "DKO",
"PKO", "PKO", "PKO",
"WT", " WT", " WT",
"SWT", "SWT", "SKO", "SKO")) )
all.df.5.design
all.df.5.DES<-DESeqDataSetFromMatrix(countData = all.df.5, colData = all.df.5.design,design = ~ condition)
all.df.5 <- as.integer(all.df.5)
all.df.5 <- lapply(all.df.5, as.integer())
all.df.5 <- lapply(all.df.5, as.integer(x))
all.df.5 <- lapply(all.df.5, as.integer())
all.df.5 <- lapply(all.df.5, as.integer)
head(all.df.5)
all.df.5.design <-data.frame(row.names=c("DKO_1", "DKO_2", "DKO_3",
"Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3",
"WT_1", "WT_2", "WT_3",
"STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2"),
condition=as.factor(c("DKO", "DKO", "DKO",
"PKO", "PKO", "PKO",
"WT", " WT", " WT",
"SWT", "SWT", "SKO", "SKO")) )
all.df.5.design
all.df.5.DES<-DESeqDataSetFromMatrix(countData = all.df.5, colData = all.df.5.design,design = ~ condition)
all.df.5.DES<-DESeq(all.df.5.DES)
head(all.df.5)
all.df.5 <- as.dataframe(lapply(all.df.5, as.integer))
all.df.5 <- as.data.frame(lapply(all.df.5, as.integer))
head(all.df.5)
all.df.5 <- subset(all.df, all.df$max.num > 5)
rownames(all.df.5) <- all.df.5[,1]
all.df.5[,1] <- NULL
all.df.5["max.num"] <- NULL
colnames(all.df.5) <- c("DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3", "WT_1", "WT_2", "WT_3", "STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2")
all.df.5.int <- as.data.frame(lapply(all.df.5, as.integer))
all.df.5.int <- as.data.frame(lapply(all.df.5, as.integer))
colnames(all.df.5.int) <- c("DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3", "WT_1", "WT_2", "WT_3", "STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2")
head(all.df.5.int)
head(all.df.5)
colnames(all.df.5.int) <- c("DKO_1", "DKO_2", "DKO_3", "Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3", "WT_1", "WT_2", "WT_3", "STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2")
rownames(all.df.5.int) <- all.df.5[,1]
head(all.df.5.int)
head(all.df.5)
rownames(all.df.5.int) <- rownames(all.df.5)
head(all.df.5.int)
head(all.df.5)
all.df.5.int.design <-data.frame(row.names=c("DKO_1", "DKO_2", "DKO_3",
"Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3",
"WT_1", "WT_2", "WT_3",
"STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2"),
condition=as.factor(c("DKO", "DKO", "DKO",
"PKO", "PKO", "PKO",
"WT", " WT", " WT",
"SWT", "SWT", "SKO", "SKO")) )
all.df.5.int.DES<-DESeqDataSetFromMatrix(countData = all.df.5.int, colData = all.df.5.design,design = ~ condition)
all.df.5.int.DES<-DESeq(all.df.5.int.DES)
all.df.5.int.DKOvs_WT <-results(all.df.5.int.DES, contrast = c("condition","DKO","WT"))
write.csv(all.df.5.int.DKOvs_WT,"all.df.5.int.DKOvs_WT.csv")
all.df.5.int.Prdm1KOvs_WT <-results(all.df.5.int.DES, contrast = c("condition","Prdm1KO","WT"))
write.csv(all.df.5.int.Prdm1KOvs_WT,"all.df.5.int.Prdm1KOvs_WT.csv")
all.df.5.int.Prdm1KOvs_WT <-results(all.df.5.int.DES, contrast = c("condition","PKO","WT"))
write.csv(all.df.5.int.Prdm1KOvs_WT,"all.df.5.int.Prdm1KOvs_WT.csv")
all.df.5.int.DKOvsPrdm1KO <-results(all.df.5.int.DES, contrast = c("condition","DKO","PKO"))
write.csv(all.df.5.int.DKOvsPrdm1KO,"DKOvsPrdm1KO.csv")
all.df.5.int.SWTvsWT <-results(all.df.5.int.DES, contrast = c("condition","SWT","WT"))
write.csv(all.df.5.int.SWTvsWT,"SWTvsWT.csv")
all.df.5.int.design <-data.frame(row.names=c("DKO_1", "DKO_2", "DKO_3",
"Prdm1KO_1", "Prdm1KO_2", "Prdm1KO_3",
"WT_1", "WT_2", "WT_3",
"STAT4WT_1", "STAT4WT_2", "STAT4KO_1", "STAT4KO_2"),
condition=as.factor(c("DKO", "DKO", "DKO",
"PKO", "PKO", "PKO",
"WT", " WT", " WT",
"SWT", "SWT", "SKO", "SKO")) )
all.df.5.int.SKOvsSWT <-results(all.df.5.int.DES, contrast = c("condition","SKO","SWT"))
write.csv(all.df.5.int.SKOvsSWT,"SKOvsSWT.csv")
